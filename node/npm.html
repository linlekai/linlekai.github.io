<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>npm包管理 | Luke 的博客</title>
    <meta name="description" content="使用Vuepress构建的博客">
    
    
    <link rel="preload" href="/assets/css/0.styles.116391f7.css" as="style"><link rel="preload" href="/assets/js/app.dfb56b79.js" as="script"><link rel="preload" href="/assets/js/2.8c8f942d.js" as="script"><link rel="preload" href="/assets/js/27.f93a4ab1.js" as="script"><link rel="prefetch" href="/assets/js/10.a8356fec.js"><link rel="prefetch" href="/assets/js/11.67de0c8f.js"><link rel="prefetch" href="/assets/js/12.b5fcaaa0.js"><link rel="prefetch" href="/assets/js/13.e0ad58d8.js"><link rel="prefetch" href="/assets/js/14.fb5287bd.js"><link rel="prefetch" href="/assets/js/15.40184857.js"><link rel="prefetch" href="/assets/js/16.fd03d0fc.js"><link rel="prefetch" href="/assets/js/17.512e0bfd.js"><link rel="prefetch" href="/assets/js/18.fc5dd68a.js"><link rel="prefetch" href="/assets/js/19.53a91487.js"><link rel="prefetch" href="/assets/js/20.1aaac42e.js"><link rel="prefetch" href="/assets/js/21.2b6b7b87.js"><link rel="prefetch" href="/assets/js/22.ae364768.js"><link rel="prefetch" href="/assets/js/23.d7ae9eb7.js"><link rel="prefetch" href="/assets/js/24.bfaad900.js"><link rel="prefetch" href="/assets/js/25.66d168bc.js"><link rel="prefetch" href="/assets/js/26.0210e606.js"><link rel="prefetch" href="/assets/js/28.5e816cc0.js"><link rel="prefetch" href="/assets/js/3.12334dbe.js"><link rel="prefetch" href="/assets/js/4.afdd57a4.js"><link rel="prefetch" href="/assets/js/5.d738a71a.js"><link rel="prefetch" href="/assets/js/6.d0b67eb3.js"><link rel="prefetch" href="/assets/js/7.9a35aca5.js"><link rel="prefetch" href="/assets/js/8.78771a7a.js"><link rel="prefetch" href="/assets/js/9.be964010.js">
    <link rel="stylesheet" href="/assets/css/0.styles.116391f7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Luke 的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/html/" class="sidebar-link">HTML</a></li><li><a href="/css/" class="sidebar-link">CSS</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/js/" class="sidebar-heading clickable"><span>JS 重点概念梳理</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/library/" class="sidebar-heading clickable"><span>前端框架</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/node/" class="sidebar-heading clickable router-link-active open"><span>node</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/node/npm.html" class="active sidebar-link">npm包管理</a></li><li><a href="/node/module.html" class="sidebar-link">常用模块</a></li><li><a href="/node/express.html" class="sidebar-link">Express</a></li><li><a href="/node/koa.html" class="sidebar-link">koa</a></li></ul></section></li><li><a href="/engineering/" class="sidebar-link">工程化</a></li><li><a href="/job/" class="sidebar-link">面试之道</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="npm包管理"><a href="#npm包管理" aria-hidden="true" class="header-anchor">#</a> npm包管理</h1> <p>npm有两层含义。一层含义是Node的开放式模块登记和管理系统，网址为npmjs.org。另一层含义是Node默认的模块管理器，是一个命令行下的软件，用来安装和管理Node模块。</p> <p>npm不需要单独安装。在安装Node的时候，会连带一起安装npm。但是，Node附带的npm可能不是最新版本，最好用下面的命令，更新到最新版本。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">npm</span> <span class="token function">install</span> npm@latest -g
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 查看 npm 命令列表</span>
$ <span class="token function">npm</span> <span class="token function">help</span>

<span class="token comment"># 查看各个命令的简单用法</span>
$ <span class="token function">npm</span> -l

<span class="token comment"># 查看 npm 的版本</span>
$ <span class="token function">npm</span> -v

<span class="token comment"># 查看 npm 的配置</span>
$ <span class="token function">npm</span> config list -l
</code></pre></div><h1 id="init"><a href="#init" aria-hidden="true" class="header-anchor">#</a> init</h1> <p>npm init用来初始化生成一个新的package.json文件。它会向用户提问一系列问题，如果你觉得不用修改默认配置，一路回车就可以了。</p> <p>如果使用了-f（代表force）、-y（代表yes），则跳过提问阶段，直接生成一个新的package.json文件。</p> <h1 id="install"><a href="#install" aria-hidden="true" class="header-anchor">#</a> install</h1> <p>Node模块采用npm install命令安装。</p> <p>每个模块可以“全局安装”，也可以“本地安装”。“全局安装”指的是将一个模块安装到系统目录中，各个项目都可以调用。一般来说，全局安装只适用于工具模块，比如eslint和gulp。“本地安装”指的是将一个模块下载到当前项目的node_modules子目录，然后只有在项目目录之中，才能调用这个模块。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 本地安装</span>
$ <span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>package name<span class="token operator">&gt;</span>

<span class="token comment"># 全局安装</span>
$ <span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> -global <span class="token operator">&lt;</span>package name<span class="token operator">&gt;</span>
$ <span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> -g <span class="token operator">&lt;</span>package name<span class="token operator">&gt;</span>
</code></pre></div><p>npm install也支持直接输入Github代码库地址。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">npm</span> <span class="token function">install</span> git://github.com/package/path.git
$ <span class="token function">npm</span> <span class="token function">install</span> git://github.com/package/path.git<span class="token comment">#0.1.0</span>
</code></pre></div><p>安装之前，npm install会先检查，node_modules目录之中是否已经存在指定模块。如果存在，就不再重新安装了，即使远程仓库已经有了一个新版本，也是如此。</p> <p>如果你希望，一个模块不管是否安装过，npm 都要强制重新安装，可以使用-f或--force参数</p> <div class="language-sh extra-class"><pre class="language-sh"><code>$ <span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>packageName<span class="token operator">&gt;</span> --force
</code></pre></div><p>如果你希望，所有模块都要强制重新安装，那就删除node_modules目录，重新执行npm install。</p> <h1 id="run"><a href="#run" aria-hidden="true" class="header-anchor">#</a> run</h1> <p>npm不仅可以用于模块管理，还可以用于执行脚本。package.json文件有一个scripts字段，可以用于指定脚本命令，供npm直接调用。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myproject&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;jshint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;latest&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;browserify&quot;</span><span class="token operator">:</span> <span class="token string">&quot;latest&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mocha&quot;</span><span class="token operator">:</span> <span class="token string">&quot;latest&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jshint **.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mocha test/&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码中，scripts字段指定了两项命令lint和test。命令行输入npm run-script lint或者npm run lint，就会执行jshint **.js，输入npm run-script test或者npm run test，就会执行mocha test/。npm run是npm run-script的缩写，一般都使用前者，但是后者可以更好地反应这个命令的本质。</p> <p>npm run命令会自动在环境变量$PATH添加node_modules/.bin目录，所以scripts字段里面调用命令时不用加上路径，这就避免了全局安装NPM模块。</p> <p>npm run如果不加任何参数，直接运行，会列出package.json里面所有可以执行的脚本命令。</p> <p>npm内置了两个命令简写，npm test等同于执行npm run test，npm start等同于执行npm run start。</p> <p>npm run会创建一个Shell，执行指定的命令，并临时将node_modules/.bin加入PATH变量，这意味着本地模块可以直接运行。</p> <p>写在scripts属性中的命令，也可以在node_modules/.bin目录中直接写成bash脚本。下面是一个bash脚本。</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token operator">!</span>/bin/bash

<span class="token function">cd</span> site/main
browserify browser/main.js <span class="token operator">|</span> uglifyjs -mc <span class="token operator">&gt;</span> static/bundle.js
</code></pre></div><p>假定上面的脚本文件名为build.sh，并且权限为可执行，就可以在scripts属性中引用该文件。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;build-js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/build.sh&quot;</span>
</code></pre></div><h1 id="cnpm"><a href="#cnpm" aria-hidden="true" class="header-anchor">#</a> cnpm</h1> <p>本地电脑环境先安装node，因为安装了node就也安装了npm, 然后最好把npm装换成cnpm。方法如下：
(在国内，npm操作可能会比较慢，建议使用cnpm，在淘宝镜像里面下载就行，用法和npm一样)
cnpm安装地址，直接安装
npm install -g cnpm --registry=https://registry.npm.taobao.org</p> <h1 id="yarn"><a href="#yarn" aria-hidden="true" class="header-anchor">#</a> yarn</h1> <p>Yarn 是 Facebook, Google, Exponent 和 Tilde 开发的一款新的 JavaScript 包管理工具。它并没有试图完全取代 npm。Yarn 同样是一个从 npm 注册源获取模块的新的 CLI 客户端。注册的方式不会有任何变化 —— 你同样可以正常获取与发布包。它存在的目的是解决团队在使用 npm 面临的少数问题。当然，在 Node 版本断更替中，Npm 本身也在积极更新。</p> <p>安装：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> --global <span class="token function">yarn</span>
</code></pre></div><p>安装默认依赖</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">yarn</span>
</code></pre></div><p>加一些依赖：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">yarn</span> <span class="token function">add</span> gulp-less  

</code></pre></div><p>如果加入具体版本可以后面写上@0.x.x
移除和更新</p> <div class="language-sh extra-class"><pre class="language-sh"><code>
<span class="token function">yarn</span> remove gulp-less  
<span class="token function">yarn</span> upgrade <span class="token punctuation">[</span>package<span class="token punctuation">]</span>  

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/library/vue.html" class="prev">
          Vue
        </a></span> <span class="next"><a href="/node/module.html">
          常用模块
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dfb56b79.js" defer></script><script src="/assets/js/2.8c8f942d.js" defer></script><script src="/assets/js/27.f93a4ab1.js" defer></script>
  </body>
</html>
